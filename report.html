<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="NGUYEN Tran Le Tuan (Student ID: 281308)">
<meta name="author" content="Ousseini Mounkaila (Student ID: 280501)">
<meta name="author" content="Class: M2-SIA">
<meta name="author" content="University: Gustave Eiffel, France">
<meta name="dcterms.date" content="2024-01-01">

<title>report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="report_files/libs/clipboard/clipboard.min.js"></script>
<script src="report_files/libs/quarto-html/quarto.js"></script>
<script src="report_files/libs/quarto-html/popper.min.js"></script>
<script src="report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="report_files/libs/quarto-html/anchor.min.js"></script>
<link href="report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="report_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">report</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>NGUYEN Tran Le Tuan (Student ID: 281308) </p>
             <p>Ousseini Mounkaila (Student ID: 280501) </p>
             <p>Class: M2-SIA </p>
             <p>University: Gustave Eiffel, France </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 1, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="abstract" class="level1">
<h1>Abstract</h1>
<p>This report presents an in-depth analysis of ridership patterns at Île-de-France’s railway stations, spanning the years 2017 to 2023. The primary objective is to develop a comprehensive dashboard that facilitates real-time monitoring and comparison of ridership against the norm, particularly highlighting variations between regular weeks and holiday periods. To achieve this aim, we have collected extensive ridership data, geographical information of railway stations, and holiday schedules. Our exploratory data analysis will focus on four key areas: station distribution, seasonality trends, monthly fluctuations, and the impact of holidays. Additionally, we will conduct statistical tests to elaborate our observations and implement time-series forecasting techniques to anticipate future ridership trends. The resulting dashboard will empower stakeholders to make informed decisions regarding resource allocation and service optimization, ensuring the efficient operation of the railway network.</p>
<section id="import-library" class="level2">
<h2 class="anchored" data-anchor-id="import-library">1. Import library</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-collection" class="level2">
<h2 class="anchored" data-anchor-id="data-collection">2. Data collection</h2>
<section id="collecting-ridership-data-from-2017-2022" class="level3">
<h3 class="anchored" data-anchor-id="collecting-ridership-data-from-2017-2022">2.1 Collecting ridership data from 2017-2022</h3>
<p>The ridership data between 2017-2022 period from Île-de-France Railway Network can be found in: <a href="https://data.iledefrance-mobilites.fr/explore/dataset/histo-validations-reseau-ferre/information/">here</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the folder path of data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="st">"Data"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty list to store the data frames</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># get data set from folder</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over the years from 2017-&gt;2022</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> <span class="dv">2017</span><span class="sc">:</span><span class="dv">2022</span>) {</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Construct the subfolder path for the current year</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  subfolder_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(folder_path, <span class="st">"/data-rf-"</span>, year, <span class="st">"/data-rf-"</span>, year)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  file_names <span class="ot">&lt;-</span> <span class="fu">list.files</span>(subfolder_path, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop over the file names and read each file</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (file_name <span class="cf">in</span> file_names) {</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Read the data file</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(file_name, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If the data has only one column, try reading with semicolon separator</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">ncol</span>(data) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>      data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(file_name, <span class="at">sep =</span> <span class="st">";"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store the data frame in the list using the file path as the key</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(file_name)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    data_list[[file_name]] <span class="ot">&lt;-</span> data</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Data/data-rf-2017/data-rf-2017/2017_S1_NB_FER.txt"
[1] "Data/data-rf-2017/data-rf-2017/2017_S2_NB_FER.txt"
[1] "Data/data-rf-2017/data-rf-2017/2017_S2_PROFIL_FER.txt"
[1] "Data/data-rf-2017/data-rf-2017/2017S1_PROFIL_FER.txt"
[1] "Data/data-rf-2018/data-rf-2018/2018_S1_NB_FER.txt"
[1] "Data/data-rf-2018/data-rf-2018/2018_S1_PROFIL_FER.txt"
[1] "Data/data-rf-2018/data-rf-2018/2018_S2_NB_FER.txt"
[1] "Data/data-rf-2018/data-rf-2018/2018_S2_Profil_Fer.txt"
[1] "Data/data-rf-2019/data-rf-2019/2019_S1_NB_FER.txt"
[1] "Data/data-rf-2019/data-rf-2019/2019_S1_PROFIL_FER.txt"
[1] "Data/data-rf-2019/data-rf-2019/2019_S2_NB_FER.txt"
[1] "Data/data-rf-2019/data-rf-2019/2019_S2_PROFIL_FER.txt"
[1] "Data/data-rf-2020/data-rf-2020/2020_S1_NB_FER.txt"
[1] "Data/data-rf-2020/data-rf-2020/2020_S1_PROFIL_FER.txt"
[1] "Data/data-rf-2020/data-rf-2020/2020_S2_NB_FER.txt"
[1] "Data/data-rf-2020/data-rf-2020/2020_S2_PROFIL_FER.txt"
[1] "Data/data-rf-2021/data-rf-2021/2021_S1_NB_FER.txt"
[1] "Data/data-rf-2021/data-rf-2021/2021_S1_PROFIL_FER.txt"
[1] "Data/data-rf-2021/data-rf-2021/2021_S2_NB_FER.txt"
[1] "Data/data-rf-2021/data-rf-2021/2021_S2_PROFIL_FER.txt"
[1] "Data/data-rf-2022/data-rf-2022/2022_S1_NB_FER.txt"
[1] "Data/data-rf-2022/data-rf-2022/2022_S1_PROFIL_FER.txt"
[1] "Data/data-rf-2022/data-rf-2022/2022_S2_NB_FER.txt"
[1] "Data/data-rf-2022/data-rf-2022/2022_S2_PROFIL_FER.txt"</code></pre>
</div>
</div>
<p>Combine the two periods data for each year.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data_years <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> <span class="dv">2017</span><span class="sc">:</span><span class="dv">2022</span>) {</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  path_file_1 <span class="ot">=</span> <span class="fu">paste0</span>(folder_path, <span class="st">"/data-rf-"</span>, year, <span class="st">"/data-rf-"</span>, year, <span class="st">"/"</span>, year, <span class="st">"_S1_NB_FER.txt"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  path_file_2 <span class="ot">=</span> <span class="fu">paste0</span>(folder_path, <span class="st">"/data-rf-"</span>, year, <span class="st">"/data-rf-"</span>, year, <span class="st">"/"</span>, year, <span class="st">"_S2_NB_FER.txt"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  data_file_1 <span class="ot">=</span> data_list[[path_file_1]]</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  data_file_2 <span class="ot">=</span> data_list[[path_file_2]]</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (year <span class="sc">==</span> <span class="dv">2022</span>) {</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(data_file_2)[<span class="fu">names</span>(data_file_2) <span class="sc">==</span> <span class="st">'lda'</span>] <span class="ot">=</span> <span class="st">'ID_REFA_LDA'</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  combined_data <span class="ot">=</span> <span class="fu">rbind</span>(data_file_1, data_file_2)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  key <span class="ot">=</span>  <span class="fu">paste0</span>(folder_path, <span class="st">"/data-rf-"</span>, year, <span class="st">"/data-rf-"</span>, year)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  data_years[[key]] <span class="ot">=</span> combined_data</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate the data from 2017-&gt;2022 into one dataframe</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(year <span class="cf">in</span> <span class="dv">2017</span><span class="sc">:</span><span class="dv">2022</span>) {</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the data frame for the current year</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  key <span class="ot">=</span>  <span class="fu">paste0</span>(folder_path, <span class="st">"/data-rf-"</span>, year, <span class="st">"/data-rf-"</span>, year)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">=</span>  data_years[[key]]</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Append the aggregated data for the current year to the final data frame</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  combined_df <span class="ot">=</span> <span class="fu">rbind</span>(combined_df, df)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="collecting-ridership-data-in-the-first-period-first-6-months-in-the-year-2023" class="level3">
<h3 class="anchored" data-anchor-id="collecting-ridership-data-in-the-first-period-first-6-months-in-the-year-2023">2.2 Collecting ridership data in the first period (first 6 months) in the year 2023</h3>
<p>Read the CSV data file for first period of 2023. This ridership data can be found in: <a href="https://data.iledefrance-mobilites.fr/explore/dataset/validations-reseau-ferre-nombre-validations-par-jour-1er-semestre/information/">here</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data_first_se_2023 <span class="ot">=</span> <span class="fu">read_csv2</span>(<span class="st">"Data/validations-reseau-ferre-nombre-validations-par-jour-1er-semestre.csv"</span>,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">JOUR =</span> <span class="fu">col_date</span>(),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">CODE_STIF_TRNS =</span> <span class="fu">col_integer</span>(),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">CODE_STIF_RES =</span> <span class="fu">col_integer</span>(),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">CODE_STIF_ARRET =</span> <span class="fu">col_character</span>(),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">LIBELLE_ARRET =</span> <span class="fu">col_character</span>(),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">lda =</span> <span class="fu">col_integer</span>(),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">CATEGORIE_TITRE =</span> <span class="fu">col_character</span>(),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">NB_VALD =</span> <span class="fu">col_integer</span>()</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                               )</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Get an overview of the data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_first_se_2023)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
  JOUR       CODE_STIF_TRNS CODE_STIF_RES CODE_STIF_ARRET LIBELLE_ARRET   lda
  &lt;date&gt;              &lt;int&gt;         &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;         &lt;int&gt;
1 2023-06-26            800           853 568             MONTSOULT     67000
2 2023-06-26            800           853 568             MONTSOULT     67000
3 2023-06-26            800           853 568             MONTSOULT     67000
4 2023-06-26            800           853 568             MONTSOULT     67000
5 2023-06-26            800           853 595             NOINTEL MOURS 67227
6 2023-06-26            800           853 595             NOINTEL MOURS 67227
# ℹ 2 more variables: CATEGORIE_TITRE &lt;chr&gt;, NB_VALD &lt;int&gt;</code></pre>
</div>
</div>
<p>The image below describes the schema of the above dataset:</p>
<p><img src="Image/schema_data_ridership.PNG" class="img-fluid"></p>
<section id="cleaning-ridership-data-from-2017-2022" class="level4">
<h4 class="anchored" data-anchor-id="cleaning-ridership-data-from-2017-2022">2.2.1 Cleaning ridership data from 2017-2022</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the format of the date column to "day-month-year"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>data_first_se_2023<span class="sc">$</span>JOUR <span class="ot">=</span> <span class="fu">format</span>(data_first_se_2023<span class="sc">$</span>JOUR, <span class="st">"%d/%m/%Y"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the column of 2023 data to match 2017-2022 data</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(data_first_se_2023)[<span class="fu">names</span>(data_first_se_2023) <span class="sc">==</span> <span class="st">'lda'</span>] <span class="ot">&lt;-</span> <span class="st">'ID_REFA_LDA'</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># sort the 2023 data as increasing order of the date time</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>data_first_se_2023 <span class="ot">=</span> data_first_se_2023 <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(JOUR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Combine data from 2017-2022 with 2023 data</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">=</span> <span class="fu">rbind</span>(combined_df, data_first_se_2023)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Change the schema of columns for the combined ridership data (from 2017-2023)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">=</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(CODE_STIF_TRNS, CODE_STIF_RES, CODE_STIF_ARRET, ID_REFA_LDA, NB_VALD), as.integer) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(LIBELLE_ARRET, CATEGORIE_TITRE), as.character)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Check the missing values of each column.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>missing_values <span class="ot">=</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(combined_df))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>missing_values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           JOUR  CODE_STIF_TRNS   CODE_STIF_RES CODE_STIF_ARRET   LIBELLE_ARRET 
              0               0            8381            8381               0 
    ID_REFA_LDA CATEGORIE_TITRE         NB_VALD 
           1832               0           27420 </code></pre>
</div>
</div>
<p>Drop rows with missing values.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">=</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(CODE_STIF_RES)) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ID_REFA_LDA)) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(NB_VALD))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Check consistency of CATEGORIE_TITRE column.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>unique_values <span class="ot">=</span> <span class="fu">unique</span>(combined_df<span class="sc">$</span>CATEGORIE_TITRE)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(unique_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AMETHYSTE"   "AUTRE TITRE" "FGT"         "IMAGINE R"   "NAVIGO"     
[6] "TST"         "NON DEFINI"  "?"           "NAVIGO JOUR"</code></pre>
</div>
</div>
<p>After checking consistency of CATEGORIE_TITRE column, we find there is anomaly data as “?” value. We need to drop this anomaly data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">=</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CATEGORIE_TITRE <span class="sc">!=</span> <span class="st">'?'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="collecting-geographical-data-of-railway-stations-in-paris" class="level3">
<h3 class="anchored" data-anchor-id="collecting-geographical-data-of-railway-stations-in-paris">2.3 Collecting geographical data of railway stations in Paris</h3>
<p>Read the geographical data. This geographical data of railway stations can be found from: <a href="https://data.iledefrance-mobilites.fr/explore/dataset/zones-d-arrets/information/?disjunctive.zdatype">here</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>geo_data <span class="ot">=</span> <span class="fu">read_csv2</span>(<span class="st">"Data/zones-d-arrets.csv"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(geo_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
   ZdAId ZdAVersion ZdACreated          ZdAChanged          ZdAName ZdAXEpsg2154
   &lt;dbl&gt; &lt;chr&gt;      &lt;dttm&gt;              &lt;dttm&gt;              &lt;chr&gt;          &lt;dbl&gt;
1 490686 1523971-1… 2023-12-27 20:55:05 2023-12-27 20:56:37 Sycomo…       652954
2  43037 43037-602… 2014-12-29 15:31:51 2023-12-27 20:56:37 Gabrie…       653348
3  43419 1433458-1… 2014-12-29 00:00:00 2023-12-27 20:56:37 Carref…       650951
4  43989 43989-608… 2014-12-29 15:31:51 2023-12-27 20:56:37 Mairie        651785
5  48274 1469106-1… 2014-12-29 15:31:51 2023-12-27 20:56:37 Châtea…       652344
6  51037 51037-627… 2014-12-29 15:31:51 2023-12-27 11:30:52 Père C…       650853
# ℹ 5 more variables: ZdAYEpsg2154 &lt;dbl&gt;, ZdCId &lt;dbl&gt;, ZdAType &lt;chr&gt;,
#   ZdAPostalRegion &lt;dbl&gt;, ZdATown &lt;chr&gt;</code></pre>
</div>
</div>
<p>The following image shows the schema of the above geographical dataset:</p>
<p><br>
<img src="Image/geo_data_schema.PNG" class="img-fluid"></p>
<section id="cleaning-geographical-data" class="level4">
<h4 class="anchored" data-anchor-id="cleaning-geographical-data">2.3.1 Cleaning geographical data</h4>
<p>Change the name of ZdCId column of geodata to the same name of Id_stopping_points column from 2017-2023 data. This will be useful for join operator of these two geodata and 2017-2023 ridership data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(geo_data)[<span class="fu">names</span>(geo_data) <span class="sc">==</span> <span class="st">'ZdCId'</span>] <span class="ot">&lt;-</span> <span class="st">'ID_REFA_LDA'</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># change the schema of ID_REFA_LDA column from chart to int</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>geo_data<span class="sc">$</span>ID_REFA_LDA <span class="ot">=</span> <span class="fu">as.integer</span>(geo_data<span class="sc">$</span>ID_REFA_LDA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Sort the geodata according to the most recent update of locations. Then we remove duplicated station names.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>geo_data <span class="ot">=</span> geo_data[<span class="fu">order</span>(geo_data<span class="sc">$</span>ZdAChanged), ]</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>geo_data <span class="ot">=</span> <span class="fu">subset</span>(geo_data, <span class="sc">!</span><span class="fu">duplicated</span>(ZdAName))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Merge the two geodata and 2017-2023 ridership data by ID_REFA_LDA column. We only keep important columns, including longitude and latitude attributes of stopping points.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>joined_df <span class="ot">=</span> <span class="fu">left_join</span>(combined_df, geo_data, <span class="at">by =</span> <span class="st">"ID_REFA_LDA"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>joined_df <span class="ot">=</span> joined_df <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="dv">14</span>, <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>After all the above pre-processing steps, we get overview of final-ready ridership dataset of railway stations for further analysis.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(joined_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        JOUR CODE_STIF_TRNS CODE_STIF_RES CODE_STIF_ARRET LIBELLE_ARRET
1 01/01/2017            100           110               1 PORTE MAILLOT
2 01/01/2017            100           110               1 PORTE MAILLOT
3 01/01/2017            100           110               1 PORTE MAILLOT
4 01/01/2017            100           110               1 PORTE MAILLOT
5 01/01/2017            100           110               1 PORTE MAILLOT
6 01/01/2017            100           110               1 PORTE MAILLOT
  ID_REFA_LDA CATEGORIE_TITRE NB_VALD ZdAXEpsg2154 ZdAYEpsg2154
1       71379       AMETHYSTE     109       647372      6864457
2       71379       AMETHYSTE     109       647247      6864373
3       71379       AMETHYSTE     109       647503      6864496
4       71379       AMETHYSTE     109       647511      6864304
5       71379       AMETHYSTE     109       647359      6864669
6       71379       AMETHYSTE     109       647144      6864431</code></pre>
</div>
</div>
</section>
</section>
<section id="collecting-the-holidays-data-in-france" class="level3">
<h3 class="anchored" data-anchor-id="collecting-the-holidays-data-in-france">2.4 Collecting the holidays data in France</h3>
<p>Thanks to author Etienne Côme, etc. the holiday dates data in France can be found from: <a href="https://www.tandfonline.com/doi/full/10.1080/23249935.2021.1948626">here</a> We first read the calendar data. It is important to note that we define holidays = official public holidays such as Christmas, school breaks, New Year Eve, etc.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>data_calendar <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"Data/calendar.csv"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_calendar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  X       date     jour ferie vacances pont mois travaux_ete ferie_semaine
1 1 2015-01-01    Jeudi     1        1    0    1           0             1
2 2 2015-01-02 Vendredi     0        1    1    1           0             0
3 3 2015-01-03   Samedi     0        1    0    1           0             0
4 4 2015-01-04 Dimanche     0        1    0    1           0             0
5 5 2015-01-05    Lundi     0        0    0    1           0             0
6 6 2015-01-06    Mardi     0        0    0    1           0             0
  ferie_weekend travaux_ete_semaine travaux_ete_weekend pont_semaine gratuite
1             0                   0                   0            0        1
2             0                   0                   0            1        0
3             0                   0                   0            0        0
4             0                   0                   0            0        0
5             0                   0                   0            0        0
6             0                   0                   0            0        0
  greves_ratp confinement deconfinement travaux_m1_semaine travaux_m1_weekend
1           0           0             0                  0                  0
2           0           0             0                  0                  0
3           0           0             0                  0                  0
4           0           0             0                  0                  0
5           0           0             0                  0                  0
6           0           0             0                  0                  0
  vacances_semaine vacances_weekend
1                1                0
2                1                0
3                0                1
4                0                1
5                0                0
6                0                0</code></pre>
</div>
</div>
<section id="cleaning-the-holidays-data" class="level4">
<h4 class="anchored" data-anchor-id="cleaning-the-holidays-data">2.4.1 Cleaning the holidays data</h4>
<p>Convert the ‘date_column’ of holidays data from char to date type.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>data_calendar<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(data_calendar<span class="sc">$</span>date, <span class="at">format=</span><span class="st">'%Y-%m-%d'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Since the holidays data is varied in each year, we choose the holiday data in 2016 (the most updated year in the calendar data) as a defining holiday dates in France. We select the ‘date’ and ‘vacances’ fields.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>date_holiday <span class="ot">=</span> data_calendar[<span class="fu">as.numeric</span>(<span class="fu">format</span>(data_calendar<span class="sc">$</span>date , <span class="st">"%Y"</span>)) <span class="sc">==</span> <span class="dv">2016</span>, ] <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">'date'</span>, <span class="st">'vacances'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Get an overview of the final-ready holidays data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(date_holiday)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          date vacances
366 2016-01-01        1
367 2016-01-02        1
368 2016-01-03        1
369 2016-01-04        0
370 2016-01-05        0
371 2016-01-06        0</code></pre>
</div>
</div>
<p>The holidays data will be used for estimating the impact of holidays period on the number of validations of railway stations in section 3.4.</p>
</section>
</section>
</section>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">3. Exploratory data analysis</h2>
<p>Converting a data column to a proper format for time-series visualization</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>joined_df<span class="sc">$</span>JOUR <span class="ot">=</span> <span class="fu">as.Date</span>(joined_df<span class="sc">$</span>JOUR, <span class="at">format =</span> <span class="st">"%d/%m/%Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Take the mean of the values for duplicated days. Then we select some columns for visualization.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>joined_df <span class="ot">=</span> joined_df <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(JOUR) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NB_VALD_MONTH =</span> <span class="fu">mean</span>(NB_VALD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">'JOUR'</span>, <span class="st">'LIBELLE_ARRET'</span>, <span class="st">'NB_VALD'</span>, <span class="st">'ZdAXEpsg2154'</span>, <span class="st">'ZdAYEpsg2154'</span>, <span class="st">'NB_VALD_MONTH'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We extract month and year of the dataset as separate columns.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>joined_df<span class="sc">$</span>MONTH <span class="ot">=</span> <span class="fu">format</span>(joined_df<span class="sc">$</span>JOUR, <span class="st">"%m"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>joined_df<span class="sc">$</span>YEAR <span class="ot">=</span> <span class="fu">format</span>(joined_df<span class="sc">$</span>JOUR, <span class="st">"%Y"</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>joined_df<span class="sc">$</span>DAY <span class="ot">=</span> <span class="fu">format</span>(joined_df<span class="sc">$</span>JOUR, <span class="st">"%d"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="railway-stations-location-of-paris-region" class="level3">
<h3 class="anchored" data-anchor-id="railway-stations-location-of-paris-region">3.1 Railway stations location of Paris region</h3>
<p><a href="#fig-railway-stations">Figure&nbsp;1</a> displays the railway stations as 2D coordinates on Paris map region.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>df_unique <span class="ot">&lt;-</span> <span class="fu">distinct</span>(joined_df, ZdAXEpsg2154, ZdAYEpsg2154, NB_VALD)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_unique, <span class="fu">aes</span>(<span class="at">x =</span> ZdAXEpsg2154, <span class="at">y =</span> ZdAYEpsg2154)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'Longtitude'</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Latitude'</span>) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Unique Coordinates of each station in Paris region'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-railway-stations" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="report_files/figure-html/fig-railway-stations-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Île-de-France railway stations locations of Paris region</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="seasonality-trend" class="level3">
<h3 class="anchored" data-anchor-id="seasonality-trend">3.2 Seasonality trend</h3>
<p><a href="#fig-seasonality">Figure&nbsp;2</a> shows the overall trend of the number of validations of Île-de-France railway stations between 2017-2023. From <a href="#fig-seasonality">Figure&nbsp;2</a>, we can see that from 2017-2020, the number of validations were high before it dropped significantly between 2020-2021; however, it started to recover from that time onwards.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(joined_df, <span class="fu">aes</span>(<span class="at">x =</span> JOUR, <span class="at">y =</span> NB_VALD, <span class="at">alpha=</span><span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">"1 year"</span>, <span class="at">date_labels =</span> <span class="st">"%Y"</span>, <span class="at">limits =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2017-01-01"</span>, <span class="st">"2023-05-31"</span>))) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span>  <span class="co"># Format y-axis labels with commas + </span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Number of Validations"</span>) <span class="sc">+</span>  <span class="co"># Add y-axis label</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-seasonality" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="report_files/figure-html/fig-seasonality-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;2: The number of validations through years</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="monthly-trend" class="level3">
<h3 class="anchored" data-anchor-id="monthly-trend">3.3 Monthly trend</h3>
<p><a href="#fig-monthly">Figure&nbsp;3</a> illustrates the distribution of the number of validations through each month, between 2017-2023. We can also see there are a lot of outliers in 2017 plot, indicating that there is a great diverse in railway station usage.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(joined_df, <span class="fu">aes</span>(<span class="at">x =</span> MONTH, <span class="at">y =</span> NB_VALD_MONTH)) <span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>YEAR, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-monthly" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="report_files/figure-html/fig-monthly-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Validations distribution through each month</figcaption>
</figure>
</div>
</div>
</div>
<p>From <a href="#fig-monthly">Figure&nbsp;3</a>, it also can be observed that in every year, August is the period that witness a quite low distributions of validations, compared to other months. It is interesting that the year 2020 and 2021 show the lowest distribution of validations, compared to other years. This phenomenon might be explaned by the Covid-19 lockdown period. <br></p>
<p>Notably, the first 6 months of 2023 indicates a very stable trend of validations.</p>
</section>
<section id="the-distributions-of-holiday-dates-in-france" class="level3">
<h3 class="anchored" data-anchor-id="the-distributions-of-holiday-dates-in-france">3.3 The distributions of holiday dates in France</h3>
<p>In this section, we plot the distributions of holiday dates in France throughout the year.</p>
<p>First, we create a pivot table for heatmap distribution.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="ot">=</span> date_holiday <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(date), <span class="at">day =</span> <span class="fu">day</span>(date)) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(month, day, vacances) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> day, <span class="at">values_from =</span> vacances, <span class="at">values_fill=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We then convert the pivot table to a matrix.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>heatmap_matrix <span class="ot">=</span> <span class="fu">as.matrix</span>(heatmap_data[, <span class="sc">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Finally, we plot the heatmap. <a href="#fig-holiday_distribution">Figure&nbsp;4</a> shows the holiday dates distribution throughout the year in France</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(heatmap_matrix,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">Rowv =</span> <span class="cn">NA</span>,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">Colv =</span> <span class="cn">NA</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"gold"</span>))(<span class="dv">100</span>),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">scale =</span> <span class="st">"none"</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Heatmap of Vacances"</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Day"</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Month"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-holiday_distribution" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="report_files/figure-html/fig-holiday_distribution-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Holiday dates distribution via day and month in France</figcaption>
</figure>
</div>
</div>
</div>
<p>It can be seen that from <a href="#fig-holiday_distribution">Figure&nbsp;4</a>, the holiday dates are mostly during labor days (by the end of April and the first day of May), the school breaks (July, August), Christmas and New Year celebration (by the end of December and the first periods of January).</p>
</section>
<section id="the-impact-of-holidays-on-the-number-of-validations" class="level3">
<h3 class="anchored" data-anchor-id="the-impact-of-holidays-on-the-number-of-validations">3.4 The impact of holidays on the number of validations</h3>
<p>We first add another ‘day’ and ‘month’ columns to holiday data. These two columns will be used for performing join operator with ridership data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>date_holiday<span class="sc">$</span>MONTH <span class="ot">=</span> <span class="fu">format</span>(date_holiday<span class="sc">$</span>date, <span class="st">"%m"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>date_holiday<span class="sc">$</span>DAY <span class="ot">=</span> <span class="fu">format</span>(date_holiday<span class="sc">$</span>date, <span class="st">"%d"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We perform left join between the 2017-2023 ridership data and the holiday data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perform left join</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>joined_df_new <span class="ot">=</span> <span class="fu">left_join</span>(joined_df, date_holiday, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"DAY"</span>, <span class="st">"MONTH"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Then, we perform the ‘group by’ operator to group duplicated dates of the ridership data, and take the mean number of validations per day.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change the format of a column year from char to int for the mean calculation</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>joined_df_new<span class="sc">$</span>YEAR <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(joined_df_new<span class="sc">$</span>YEAR)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># take the the mean of NB_VALD for each day</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>df_validation_avg <span class="ot">&lt;-</span> joined_df_new <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(JOUR) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">AVG_NB_VALD =</span> <span class="fu">mean</span>(NB_VALD), <span class="at">YEAR =</span> <span class="fu">mean</span>(YEAR), <span class="at">VACANCES =</span> <span class="fu">mean</span>(vacances))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Finally, we create a line plot between 2017-2023 for the mean number of validations per day. <a href="#fig-mean_vald_through_years">Figure&nbsp;5</a> highlights the impact of holidays on the validations</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_validation_avg, <span class="fu">aes</span>(JOUR, AVG_NB_VALD, <span class="at">color=</span><span class="fu">factor</span>(VACANCES))) <span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> YEAR, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">labels =</span> month.abb) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average validations per day"</span>) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mean_vald_through_years" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="report_files/figure-html/fig-mean_vald_through_years-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;5: The daily average number of validations</figcaption>
</figure>
</div>
</div>
</div>
<p>From <a href="#fig-mean_vald_through_years">Figure&nbsp;5</a>, it can be seen that there is an decreasing trend in the number of validations during holidays, most notably in the years 2017, 2018, 2019 and 2022.</p>
</section>
</section>
<section id="statistical-tests" class="level2">
<h2 class="anchored" data-anchor-id="statistical-tests">4. Statistical tests</h2>
<p>In this sections, we apply simple statistical methods to validate key findings from the section 3 (Exploratory data analysis), and draw meaningful insights from the considered data.</p>
<p>Before applying statistical methods, we first check the distribution of validations variable.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(joined_df, <span class="fu">aes</span>(<span class="at">x =</span> NB_VALD)) <span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Validations"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>, <span class="at">title =</span> <span class="st">"Distribution of Validations"</span>) <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma)  <span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-dist-vald" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="report_files/figure-html/fig-dist-vald-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;6: The distribution of validations variable</figcaption>
</figure>
</div>
</div>
</div>
<p>From <a href="#fig-dist-vald">Figure&nbsp;6</a>, it can be seen that the distribution of validation variable is right-skewed and likely to follow a logarithm-distribution. For many hypothesis testing, it is assumed that the considered variable should follow a normal distribution (<a href="https://scholarworks.wm.edu/oer/3/">here</a>). Therefore, we apply the log-transformation to turn it into the desired normal distribution.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>joined_df<span class="sc">$</span>NB_VALD <span class="ot">=</span> <span class="fu">log</span>(joined_df<span class="sc">$</span>NB_VALD)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(joined_df, <span class="fu">aes</span>(<span class="at">x =</span> NB_VALD)) <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Validations"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>, <span class="at">title =</span> <span class="st">"Distribution of Validations"</span>) <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma)  <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-dist-log-vald" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="report_files/figure-html/fig-dist-log-vald-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;7: The distribution of validations variable after log() transformation</figcaption>
</figure>
</div>
</div>
</div>
<section id="seasonal-hypothesis-testing" class="level3">
<h3 class="anchored" data-anchor-id="seasonal-hypothesis-testing">4.1 Seasonal hypothesis testing</h3>
<p>From section 3.3, it can be assumed that the validations distribution of the year 2020-2021 are quite low compared to other years. We will conduct the T-test method (<a href="https://synapse.koreamed.org/articles/1156170">here</a>) to validate this assumption.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>before_2020 <span class="ot">=</span> <span class="fu">subset</span>(joined_df, YEAR <span class="sc">&lt;</span> <span class="dv">2020</span>)<span class="sc">$</span>NB_VALD</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>after_2020 <span class="ot">=</span> <span class="fu">subset</span>(joined_df, YEAR <span class="sc">&gt;=</span> <span class="dv">2020</span>)<span class="sc">$</span>NB_VALD</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We perform the T-test method of the above subset data with the confident level = 95%.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>t_test_2020 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(before_2020, after_2020)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_2020)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  before_2020 and after_2020
t = 120.47, df = 10035293, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.1474408 0.1523176
sample estimates:
mean of x mean of y 
 5.039071  4.889192 </code></pre>
</div>
</div>
<p>The p-value after the T-test is less than 2.2e-16, which is essentially zero. A very small p-value indicates that the drop in validations of 2020-2021 period is happened systematically not randomly. This change can be influenced by the Covid-19 period, but this analysis is out of the scope of our project report.</p>
</section>
<section id="school-breaks-hypothesis-testing" class="level3">
<h3 class="anchored" data-anchor-id="school-breaks-hypothesis-testing">4.2 School breaks hypothesis testing</h3>
<p>We also want to see if the school breaks (during July-August) has impact on the number of validations of railway stations in Paris. We will utilize the T-test method for this hypothesis.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset data during the school breaks</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>august_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(joined_df, MONTH <span class="sc">==</span> <span class="st">'08'</span>)<span class="sc">$</span>NB_VALD</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset data for other months</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>other_months_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(joined_df, MONTH <span class="sc">!=</span> <span class="st">'8'</span>)<span class="sc">$</span>NB_VALD</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We perform the T-test method of the above extracted subset data with the confident level = 95%.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>t_test_seasonal <span class="ot">=</span> <span class="fu">t.test</span>(august_data, other_months_data)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_seasonal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  august_data and other_months_data
t = -84.836, df = 1040019, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.1943995 -0.1856198
sample estimates:
mean of x mean of y 
 4.756607  4.946617 </code></pre>
</div>
</div>
<p>In this case, the small p-value suggests that there is a systematic change (a decreasing trend) in the ridership pattern during the school breaks period.</p>
</section>
<section id="holidays-hypothesis-testing" class="level3">
<h3 class="anchored" data-anchor-id="holidays-hypothesis-testing">4.3 Holidays hypothesis testing</h3>
<p>Similar to section 4.1 and 4.2, we also apply the T-test statistical method to validate whether or not the ridership pattern is influenced by the holiday dates in France. According to section 3.4, we form a hypothesis that considers the number of validations is reduced during holidays compared to non-holiday dates.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>holiday_data <span class="ot">=</span> <span class="fu">subset</span>(joined_df_new, vacances <span class="sc">==</span> <span class="dv">1</span>)<span class="sc">$</span>NB_VALD</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>non_holiday_data <span class="ot">=</span> <span class="fu">subset</span>(joined_df_new, vacances <span class="sc">==</span> <span class="sc">!</span><span class="dv">1</span>)<span class="sc">$</span>NB_VALD</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We conduct the T-test method on the two subset holiday and non-holiday dates. Note that the significance level is set to <span class="math inline">\(\alpha\)</span> = 0.05, or confidence level <span class="math inline">\(c = 1 - \alpha\)</span> prior the experiment.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>t_test_impact_holiday <span class="ot">=</span> <span class="fu">t.test</span>(holiday_data, non_holiday_data)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_impact_holiday)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  holiday_data and non_holiday_data
t = -76.078, df = 8273931, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -165.6048 -157.2863
sample estimates:
mean of x mean of y 
 929.9955 1091.4410 </code></pre>
</div>
</div>
<p>After the T-test experiment, the p-value obtained is less than 2.2e-16, which suggest the acceptance of our hypothesis (there is a drop in the number of validations during holiday periods).</p>
</section>
<section id="times-series-forecasting" class="level3">
<h3 class="anchored" data-anchor-id="times-series-forecasting">4.3 Times-series forecasting</h3>
<p>In this section, we use the time-series model, called HOLT-WINTERS, (<a href="https://c.mql5.com/forextsd/forum/69/exponentialsmoothing.pdf">here</a>) to estimate the mean number of validations per day for railway stations. HOLT-WINTERS uses a technique called exponential smoothing, which means that it gives more weight to the recent data points and less weight to the older ones. This way, it can adapt to the changes in the time series over time.</p>
<p>We first create a time-series object with the index time from 2017-2023 and the values are the average number of validations per day.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the start and end dates</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">min</span>(df_validation_avg<span class="sc">$</span>JOUR)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">max</span>(df_validation_avg<span class="sc">$</span>JOUR)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a time series object using the AVG_NB_VALD column</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>ts_data <span class="ot">&lt;-</span> <span class="fu">ts</span>(df_validation_avg<span class="sc">$</span>AVG_NB_VALD, <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">year</span>(start_date), <span class="fu">month</span>(start_date)), <span class="at">end =</span> <span class="fu">c</span>(<span class="fu">year</span>(end_date), <span class="fu">month</span>(end_date)), <span class="at">frequency =</span> <span class="dv">365</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We then try to estimate the actual values of validations trend.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>ts_data_estimated <span class="ot">=</span> <span class="fu">HoltWinters</span>(ts_data, <span class="at">beta=</span><span class="cn">FALSE</span>, <span class="at">gamma=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We forecast future validations using the estimated validations trend. In this case, we aim to forecast the mean validations for the next 365 days.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>forecast_data <span class="ot">=</span> <span class="fu">forecast</span>(ts_data_estimated, <span class="at">h=</span><span class="dv">365</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Finally, we visualize the actual validation trend, the estimation, and the future values for the next 365 days.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(forecast_data, <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">lty =</span> <span class="st">"dashed"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"Mean validations per day"</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(ts_data, <span class="at">col=</span><span class="st">'orange'</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.4</span>, <span class="at">lty =</span> <span class="st">"dashed"</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Estimated"</span>, <span class="st">"Actual"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"orange"</span>), <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-forecast" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="report_files/figure-html/fig-forecast-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;8: Holt-Winters Forecast for the average number of validations per day</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-forecast">Figure&nbsp;8</a>, the 80% prediction interval are the blue shaded area, while the 95% prediction interval are the grey area. It can be seen that railway network’s ridership trend expect to have around 900-1500 validations per day as it approaches to the last 6 months of 2024.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">5. Conclusion</h2>
<p>In conclusion, this report has delved into the ridership patterns of Île-de-France’s railway stations, providing a comprehensive overview of passenger trends from 2017 to 2023. The statistical tests suggest that there is a systematic change (a decreasing trend) in the ridership pattern during the holiday periods in France. Also, based on the HOLT-WINTERS time-series model, it is expected that the Île-de-France’s railway stations continue to recover after the 2020-2021 drop in railway usages, and it is estimated to have around 900-1500 validations per day by the end of 2024. Finally, the interactive dashboard for key insights visualization can be found in the github of the project.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>